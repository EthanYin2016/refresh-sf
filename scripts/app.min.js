window.ENV={},window.ENV.apiUrl="http://refresh-sf.herokuapp.com/",Ember.TEMPLATES.compressor=Ember.Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e="";return b.buffer.push('\n\n  <div class="row">\n    <div class="col-lg-6"><h2>Input</h2></div>\n    <div class="col-lg-6 text-right compressed-actions">\n      <div class="btn-group">\n        <button type="button" '),b.buffer.push(r(c["bind-attr"].call(a,{hash:{disabled:"isCompressing","class":":btn guessJavascript:btn-primary"},hashTypes:{disabled:"ID","class":"STRING"},hashContexts:{disabled:a,"class":a},contexts:[],types:[],data:b}))),b.buffer.push(" "),b.buffer.push(r(c.action.call(a,"compress","javascript",{hash:{},hashTypes:{},hashContexts:{},contexts:[a,a],types:["STRING","STRING"],data:b}))),b.buffer.push('><span class="glyphicon glyphicon-resize-small"></span> Javascript</button>\n        <button type="button" '),b.buffer.push(r(c["bind-attr"].call(a,{hash:{disabled:"isCompressing","class":":btn guessCss:btn-primary"},hashTypes:{disabled:"ID","class":"STRING"},hashContexts:{disabled:a,"class":a},contexts:[],types:[],data:b}))),b.buffer.push(" "),b.buffer.push(r(c.action.call(a,"compress","css",{hash:{},hashTypes:{},hashContexts:{},contexts:[a,a],types:["STRING","STRING"],data:b}))),b.buffer.push('><span class="glyphicon glyphicon-resize-small"></span> CSS</button>\n        <button type="button" '),b.buffer.push(r(c["bind-attr"].call(a,{hash:{disabled:"isCompressing","class":":btn guessHtml:btn-primary"},hashTypes:{disabled:"ID","class":"STRING"},hashContexts:{disabled:a,"class":a},contexts:[],types:[],data:b}))),b.buffer.push(" "),b.buffer.push(r(c.action.call(a,"compress","html",{hash:{},hashTypes:{},hashContexts:{},contexts:[a,a],types:["STRING","STRING"],data:b}))),b.buffer.push('><span class="glyphicon glyphicon-resize-small"></span> HTML</button>\n      </div>\n    </div>\n  </div>\n\n  <div class="row">\n    <div class="col-lg-12">\n      <div class="form-group">\n        '),b.buffer.push(r(c.view.call(a,"App.DragAndDrop",{hash:{value:"input","class":"form-control input",rows:"10",placeholder:"placeholder",disabled:"isCompressing"},hashTypes:{value:"ID","class":"STRING",rows:"STRING",placeholder:"ID",disabled:"ID"},hashContexts:{value:a,"class":a,rows:a,placeholder:a,disabled:a},contexts:[a],types:["ID"],data:b}))),b.buffer.push("\n      </div>\n      <div "),b.buffer.push(r(c["bind-attr"].call(a,{hash:{"class":":form-group isHtml::checkbox"},hashTypes:{"class":"STRING"},hashContexts:{"class":a},contexts:[],types:[],data:b}))),b.buffer.push(">\n        "),d=c["if"].call(a,"isHtml",{hash:{},hashTypes:{},hashContexts:{},inverse:s.program(4,h,b),fn:s.program(2,g,b),contexts:[a],types:["ID"],data:b}),(d||0===d)&&b.buffer.push(d),b.buffer.push("\n      </div>\n    </div>\n  </div>\n\n"),e}function g(a,b){b.buffer.push('\n          <span class="text-warning">YUI Compressor does not support HTML compression.</span>\n            ')}function h(a,b){var d,e,f="";return b.buffer.push("\n          <label>\n            "),b.buffer.push(r((d=c.input||a&&a.input,e={hash:{type:"checkbox",checked:"useYui"},hashTypes:{type:"STRING",checked:"ID"},hashContexts:{type:a,checked:a},contexts:[],types:[],data:b},d?d.call(a,e):q.call(a,"input",e)))),b.buffer.push("\n            Use YUI Compressor instead of UglifyJS/Clean-CSS.\n          </label>\n        "),f}function i(a,b){var d,e="";return b.buffer.push('\n\n  <div class="row">\n    <div class="col-lg-6">\n      <h2>Compressed '),d=c._triageMustache.call(a,"displayLanguage",{hash:{},hashTypes:{},hashContexts:{},contexts:[a],types:["ID"],data:b}),(d||0===d)&&b.buffer.push(d),b.buffer.push('</h2>\n    </div>\n    <div class="col-lg-6 text-right compressed-actions">\n      '),d=c["if"].call(a,"error",{hash:{},hashTypes:{},hashContexts:{},inverse:s.program(9,k,b),fn:s.program(7,j,b),contexts:[a],types:["ID"],data:b}),(d||0===d)&&b.buffer.push(d),b.buffer.push('\n    </div>\n  </div>\n\n  <div class="row">\n    <div class="col-lg-12">\n      '),b.buffer.push(r(c.view.call(a,"App.OutputTextArea",{hash:{classBinding:":form-control :alert error:alert-danger:alert-success",rows:"10",value:"output"},hashTypes:{classBinding:"STRING",rows:"STRING",value:"ID"},hashContexts:{classBinding:a,rows:a,value:a},contexts:[a],types:["ID"],data:b}))),b.buffer.push('\n    </div>\n  </div>\n\n  <div class="row">\n    <div class="col-lg-12">\n      <button type="button" class="btn btn-primary" '),b.buffer.push(r(c.action.call(a,"createGist",{hash:{},hashTypes:{},hashContexts:{},contexts:[a],types:["STRING"],data:b}))),b.buffer.push(">Create Anonymous Gist</button>\n      "),d=c["if"].call(a,"gistUrl",{hash:{},hashTypes:{},hashContexts:{},inverse:s.noop,fn:s.program(11,l,b),contexts:[a],types:["ID"],data:b}),(d||0===d)&&b.buffer.push(d),b.buffer.push("\n    </div>\n  </div>\n\n"),e}function j(a,b){var d="";return b.buffer.push('\n        <button type="button" class="btn btn-default" '),b.buffer.push(r(c.action.call(a,"resetCompressor",{hash:{},hashTypes:{},hashContexts:{},contexts:[a],types:["STRING"],data:b}))),b.buffer.push('><span class="glyphicon glyphicon-refresh"></span> Reset</button>\n      '),d}function k(a,b){var d,e,f="";return b.buffer.push('\n        <div class="input-group">\n          '),b.buffer.push(r((d=c.input||a&&a.input,e={hash:{"class":"form-control",value:"filename"},hashTypes:{"class":"STRING",value:"ID"},hashContexts:{"class":a,value:a},contexts:[],types:[],data:b},d?d.call(a,e):q.call(a,"input",e)))),b.buffer.push('\n          <span class="input-group-btn">\n            <button type="button" class="btn btn-primary" '),b.buffer.push(r(c.action.call(a,"save",{hash:{},hashTypes:{},hashContexts:{},contexts:[a],types:["STRING"],data:b}))),b.buffer.push(" "),b.buffer.push(r(c["bind-attr"].call(a,{hash:{disabled:"saveDisabled"},hashTypes:{disabled:"ID"},hashContexts:{disabled:a},contexts:[],types:[],data:b}))),b.buffer.push('><span class="glyphicon glyphicon-save"></span> Save</button>\n            <button type="button" class="btn btn-primary" '),b.buffer.push(r(c.action.call(a,"saveGzip",{hash:{},hashTypes:{},hashContexts:{},contexts:[a],types:["STRING"],data:b}))),b.buffer.push('><span class="glyphicon glyphicon-resize-small"></span> gzip</button>\n            <button type="button" class="btn btn-default" '),b.buffer.push(r(c.action.call(a,"resetCompressor",{hash:{},hashTypes:{},hashContexts:{},contexts:[a],types:["STRING"],data:b}))),b.buffer.push('><span class="glyphicon glyphicon-refresh"></span> Reset</button>\n          </span>\n        </div>\n      '),f}function l(a,b){var d,e="";return b.buffer.push("<a "),b.buffer.push(r(c["bind-attr"].call(a,{hash:{href:"gistUrl"},hashTypes:{href:"ID"},hashContexts:{href:a},contexts:[],types:[],data:b}))),b.buffer.push(">"),d=c._triageMustache.call(a,"gistUrl",{hash:{},hashTypes:{},hashContexts:{},contexts:[a],types:["ID"],data:b}),(d||0===d)&&b.buffer.push(d),b.buffer.push("</a>"),e}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,Ember.Handlebars.helpers),e=e||{};var m,n,o,p="",q=c.helperMissing,r=this.escapeExpression,s=this;return m=c.unless.call(b,"output",{hash:{},hashTypes:{},hashContexts:{},inverse:s.program(6,i,e),fn:s.program(1,f,e),contexts:[b],types:["ID"],data:e}),(m||0===m)&&e.buffer.push(m),e.buffer.push("\n\n\n<form "),e.buffer.push(r(c["bind-attr"].call(b,{hash:{action:"gzipUrl"},hashTypes:{action:"ID"},hashContexts:{action:b},contexts:[],types:[],data:e}))),e.buffer.push(' method="post">\n  '),e.buffer.push(r((n=c.input||b&&b.input,o={hash:{name:"code",value:"output",type:"hidden"},hashTypes:{name:"STRING",value:"ID",type:"STRING"},hashContexts:{name:b,value:b,type:b},contexts:[],types:[],data:e},n?n.call(b,o):q.call(b,"input",o)))),e.buffer.push("\n</form>\n"),p}),function(){"use strict";Ember.throttledObserver=function(a,b,c){return Em.observer(function(){Em.run.throttle(this,a,c)},b)};var a=Ember.Application.create({rootElement:"#compressor",LOG_ACTIVE_GENERATION:!0,LOG_MODULE_RESOLVER:!0,LOG_TRANSITIONS:!0,LOG_TRANSITIONS_INTERNAL:!0,LOG_VIEW_LOOKUPS:!0});a.Router.map(function(){this.route("compressor",{path:"/"})}),a.CompressorRoute=Ember.Route.extend(),a.CompressorController=Ember.Controller.extend({placeholder:"Paste your JavaScript or CSS code here, or drag in files from your desktop.",apiUrl:window.ENV.apiUrl,language:null,languages:["javascript","css","html"],useYui:localStorage.getItem("useYui"),rememberYui:function(){this.get("useYui")?localStorage.setItem("useYui",!0):localStorage.removeItem("useYui")}.observes("useYui"),isHtml:function(){return"html"===this.get("language")}.property("language"),gzipUrl:function(){return this.get("apiUrl")+"gz/"+this.get("filename")}.property("apiUrl","filename"),saveDisabled:function(){return!this.get("filename")}.property("filename"),compressDisabled:function(){return!this.get("input")||!this.get("language")||this.get("isCompressing")}.property("input","language","isCompressing"),guessJavascript:function(){return"javascript"===this.get("language")}.property("language"),guessCss:function(){return"css"===this.get("language")}.property("language"),guessHtml:function(){return"html"===this.get("language")}.property("language"),checkLanguage:Ember.throttledObserver(function(){if(this.set("unknownLanguage",null),this.set("language",null),!Ember.isEmpty(this.get("input"))){var a=this.get("input").replace(),b=hljs.highlightAuto(a,this.get("languages"));this.set("language",b.language),this.get("language")||this.set("unknownLanguage",!0)}},"input",500),displayLanguage:function(){switch(this.get("language")){case"javascript":return"Javascript";case"css":return"CSS";case"html":return"HTML";default:return null}}.property("language"),compress:function(a){this.set("output",null),this.set("error",null),this.set("isCompressing",!0);var b=this.get("useYui")&&"html"!==a?"yui":a;return new Ember.RSVP.Promise(function(a,c){Ember.$.ajax({url:this.get("apiUrl")+b+"/",type:"post",data:{code:this.get("input"),type:this.get("language")},dataType:"json"}).done(function(b){a(b.code)}.bind(this)).fail(function(a){this.set("error",!0),c(a.responseJSON.yuiError?a.responseJSON.yuiError:JSON.stringify(a.responseJSON,null,2))}.bind(this)).always(function(){this.set("isCompressing",!1)}.bind(this))}.bind(this))},actions:{compress:function(a){a=a||this.get("language"),this.compress(a).then(function(b){if(this.set("output",b),!this.get("filename"))switch(a){case"css":this.set("filename","style.min.css");break;case"javascript":this.set("filename","app.min.js");break;case"html":this.set("filename","index.min.html")}}.bind(this),function(a){this.set("error",!0),this.set("output",a)}.bind(this))},save:function(){var a=new Blob([this.get("output")],{type:"text/"+this.get("language")+";charset=utf-8"});saveAs(a,this.get("filename"))},saveGzip:function(){Ember.$("form").trigger("submit")},resetCompressor:function(){this.set("input",null),this.set("output",null)},createGist:function(){var a=this,b={files:{}};b.files[this.get("filename")]={content:this.get("output")},$.ajax({url:"https://api.github.com/gists",type:"POST",dataType:"json",data:JSON.stringify(b)}).done(function(b){a.set("gistUrl",b.files[a.get("filename")].raw_url)})}}}),a.DragAndDrop=Ember.TextArea.extend({didInsertElement:function(){this.$().fileReaderJS({accept:"text/*",dragClass:"dragging",readAsDefault:"Text",on:{load:function(a,b){this.set("value",this.getWithDefault("value","")+a.target.result);var c=b.name.split(".");c.splice(-1,0,"min"),this.set("parentView.controller.filename",c.join("."))}.bind(this)}}),this.$().focus().select()}}),a.OutputTextArea=Ember.TextArea.extend({didInsertElement:function(){this.get("parentView.controller.error")||this.$().focus().select()}}),window.App=a}();