window.ENV={},window.ENV.apiUrl="http://refresh-sf.herokuapp.com/",Ember.TEMPLATES.compressor=Ember.Handlebars.template(function(a,b,c,d,e){function f(a,b){var d,e,f,h="";return b.buffer.push('\n\n  <div class="row">\n    <div class="col-lg-12">\n      <h2>\n        '),d=c.unless.call(a,"compressDisabled",{hash:{},hashTypes:{},hashContexts:{},inverse:q.noop,fn:q.program(2,g,b),contexts:[a],types:["ID"],data:b}),(d||0===d)&&b.buffer.push(d),b.buffer.push('\n        Input Code\n      </h2>\n      <div class="form-group">\n        '),b.buffer.push(p(c.view.call(a,"App.DragAndDrop",{hash:{value:"input","class":"form-control input",rows:"10",placeholder:"placeholder",disabled:"isCompressing"},hashTypes:{value:"ID","class":"STRING",rows:"STRING",placeholder:"ID",disabled:"ID"},hashContexts:{value:a,"class":a,rows:a,placeholder:a,disabled:a},contexts:[a],types:["ID"],data:b}))),b.buffer.push('\n      </div>\n      <div class="form-group checkbox">\n        <label>\n          '),b.buffer.push(p((e=c.input||a&&a.input,f={hash:{type:"checkbox",checked:"useYui"},hashTypes:{type:"STRING",checked:"ID"},hashContexts:{type:a,checked:a},contexts:[],types:[],data:b},e?e.call(a,f):r.call(a,"input",f)))),b.buffer.push("\n          Use YUI Compressor instead of UglifyJS/Clean-CSS.\n        </label>\n      </div>\n    </div>\n  </div>\n\n"),h}function g(a,b){var d,e="";return b.buffer.push('\n          <button type="button" class="btn btn-primary pull-right" '),b.buffer.push(p(c.action.call(a,"compress",{hash:{},hashTypes:{},hashContexts:{},contexts:[a],types:["STRING"],data:b}))),b.buffer.push(" "),b.buffer.push(p(c["bind-attr"].call(a,{hash:{disabled:"compressDisabled"},hashTypes:{disabled:"ID"},hashContexts:{disabled:a},contexts:[],types:[],data:b}))),b.buffer.push('><span class="glyphicon glyphicon-resize-small"></span> Compress '),d=c._triageMustache.call(a,"displayLanguage",{hash:{},hashTypes:{},hashContexts:{},contexts:[a],types:["ID"],data:b}),(d||0===d)&&b.buffer.push(d),b.buffer.push("</button>\n        "),e}function h(a,b){var d,e="";return b.buffer.push('\n\n  <div class="row">\n    <div class="col-lg-6">\n      <h2>Compressed '),d=c._triageMustache.call(a,"displayLanguage",{hash:{},hashTypes:{},hashContexts:{},contexts:[a],types:["ID"],data:b}),(d||0===d)&&b.buffer.push(d),b.buffer.push('</h2>\n    </div>\n    <div class="col-lg-6 text-right compressed-actions">\n      '),d=c["if"].call(a,"error",{hash:{},hashTypes:{},hashContexts:{},inverse:q.program(7,j,b),fn:q.program(5,i,b),contexts:[a],types:["ID"],data:b}),(d||0===d)&&b.buffer.push(d),b.buffer.push('\n    </div>\n  </div>\n\n  <div class="row">\n    <div class="col-lg-12">\n      '),b.buffer.push(p(c.view.call(a,"App.OutputTextArea",{hash:{classBinding:":form-control :alert error:alert-danger:alert-success",rows:"10",value:"output"},hashTypes:{classBinding:"STRING",rows:"STRING",value:"ID"},hashContexts:{classBinding:a,rows:a,value:a},contexts:[a],types:["ID"],data:b}))),b.buffer.push('\n    </div>\n  </div>\n\n  <div class="row">\n    <div class="col-lg-12">\n      <button type="button" class="btn btn-primary" '),b.buffer.push(p(c.action.call(a,"createGist",{hash:{},hashTypes:{},hashContexts:{},contexts:[a],types:["STRING"],data:b}))),b.buffer.push(">Create Anonymous Gist</button>\n      "),d=c["if"].call(a,"gistUrl",{hash:{},hashTypes:{},hashContexts:{},inverse:q.noop,fn:q.program(9,k,b),contexts:[a],types:["ID"],data:b}),(d||0===d)&&b.buffer.push(d),b.buffer.push("\n    </div>\n  </div>\n\n"),e}function i(a,b){var d="";return b.buffer.push('\n        <button type="button" class="btn btn-default" '),b.buffer.push(p(c.action.call(a,"resetCompressor",{hash:{},hashTypes:{},hashContexts:{},contexts:[a],types:["STRING"],data:b}))),b.buffer.push('><span class="glyphicon glyphicon-refresh"></span> Reset</button>\n      '),d}function j(a,b){var d,e,f="";return b.buffer.push('\n        <div class="input-group">\n          '),b.buffer.push(p((d=c.input||a&&a.input,e={hash:{"class":"form-control",value:"filename"},hashTypes:{"class":"STRING",value:"ID"},hashContexts:{"class":a,value:a},contexts:[],types:[],data:b},d?d.call(a,e):r.call(a,"input",e)))),b.buffer.push('\n          <span class="input-group-btn">\n            <button type="button" class="btn btn-primary" '),b.buffer.push(p(c.action.call(a,"save",{hash:{},hashTypes:{},hashContexts:{},contexts:[a],types:["STRING"],data:b}))),b.buffer.push(" "),b.buffer.push(p(c["bind-attr"].call(a,{hash:{disabled:"saveDisabled"},hashTypes:{disabled:"ID"},hashContexts:{disabled:a},contexts:[],types:[],data:b}))),b.buffer.push('><span class="glyphicon glyphicon-save"></span> Save</button>\n            <button type="button" class="btn btn-primary" '),b.buffer.push(p(c.action.call(a,"saveGzip",{hash:{},hashTypes:{},hashContexts:{},contexts:[a],types:["STRING"],data:b}))),b.buffer.push('><span class="glyphicon glyphicon-resize-small"></span> gzip</button>\n            <button type="button" class="btn btn-default" '),b.buffer.push(p(c.action.call(a,"resetCompressor",{hash:{},hashTypes:{},hashContexts:{},contexts:[a],types:["STRING"],data:b}))),b.buffer.push('><span class="glyphicon glyphicon-refresh"></span> Reset</button>\n          </span>\n        </div>\n      '),f}function k(a,b){var d,e="";return b.buffer.push("<a "),b.buffer.push(p(c["bind-attr"].call(a,{hash:{href:"gistUrl"},hashTypes:{href:"ID"},hashContexts:{href:a},contexts:[],types:[],data:b}))),b.buffer.push(">"),d=c._triageMustache.call(a,"gistUrl",{hash:{},hashTypes:{},hashContexts:{},contexts:[a],types:["ID"],data:b}),(d||0===d)&&b.buffer.push(d),b.buffer.push("</a>"),e}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,Ember.Handlebars.helpers),e=e||{};var l,m,n,o="",p=this.escapeExpression,q=this,r=c.helperMissing;return l=c.unless.call(b,"output",{hash:{},hashTypes:{},hashContexts:{},inverse:q.program(4,h,e),fn:q.program(1,f,e),contexts:[b],types:["ID"],data:e}),(l||0===l)&&e.buffer.push(l),e.buffer.push("\n\n\n<form "),e.buffer.push(p(c["bind-attr"].call(b,{hash:{action:"gzipUrl"},hashTypes:{action:"ID"},hashContexts:{action:b},contexts:[],types:[],data:e}))),e.buffer.push(' method="post">\n  '),e.buffer.push(p((m=c.input||b&&b.input,n={hash:{name:"code",value:"output",type:"hidden"},hashTypes:{name:"STRING",value:"ID",type:"STRING"},hashContexts:{name:b,value:b,type:b},contexts:[],types:[],data:e},m?m.call(b,n):r.call(b,"input",n)))),e.buffer.push("\n</form>\n"),o}),function(){"use strict";Ember.throttledObserver=function(a,b,c){return Em.observer(function(){Em.run.throttle(this,a,c)},b)};var a=Ember.Application.create({rootElement:"#compressor",LOG_ACTIVE_GENERATION:!0,LOG_MODULE_RESOLVER:!0,LOG_TRANSITIONS:!0,LOG_TRANSITIONS_INTERNAL:!0,LOG_VIEW_LOOKUPS:!0});a.Router.map(function(){this.route("compressor",{path:"/"})}),a.CompressorRoute=Ember.Route.extend(),a.CompressorController=Ember.Controller.extend({placeholder:"Paste your JavaScript or CSS code here, or drag in files from your desktop.",apiUrl:window.ENV.apiUrl,language:null,languages:["javascript","css"],useYui:localStorage.getItem("useYui"),rememberYui:function(){this.get("useYui")?localStorage.setItem("useYui",!0):localStorage.removeItem("useYui")}.observes("useYui"),gzipUrl:function(){return this.get("apiUrl")+"gz/"+this.get("filename")}.property("apiUrl","filename"),saveDisabled:function(){return!this.get("filename")}.property("filename"),compressDisabled:function(){return!this.get("input")||!this.get("language")||this.get("isCompressing")}.property("input","language","isCompressing"),checkLanguage:Ember.throttledObserver(function(){if(!Ember.isEmpty(this.get("input"))){var a=this.get("input").replace(),b=hljs.highlightAuto(a,this.get("languages"));this.set("language",b.language)}},"input",500),displayLanguage:function(){switch(this.get("language")){case"javascript":return"JavaScript";case"css":return"CSS";default:return null}}.property("language"),compress:function(){this.set("output",null),this.set("error",null),this.set("isCompressing",!0);var a=this.get("apiUrl")+(this.get("useYui")?"yui":this.get("language"))+"/";return new Ember.RSVP.Promise(function(b,c){Ember.$.ajax({url:a,type:"post",data:{code:this.get("input"),type:this.get("language")},dataType:"json"}).done(function(a){b(a.code)}.bind(this)).fail(function(a){this.set("error",!0),c(a.responseJSON.yuiError?a.responseJSON.yuiError:JSON.stringify(a.responseJSON,null,2))}.bind(this)).always(function(){this.set("isCompressing",!1)}.bind(this))}.bind(this))},actions:{compress:function(){this.compress().then(function(a){this.set("output",a),this.get("filename")||("css"===this.get("language")?this.set("filename","style.min.css"):this.set("filename","app.min.js"))}.bind(this),function(a){this.set("error",!0),this.set("output",a)}.bind(this))},save:function(){var a=new Blob([this.get("output")],{type:"text/"+this.get("language")+";charset=utf-8"});saveAs(a,this.get("filename"))},saveGzip:function(){Ember.$("form").trigger("submit")},resetCompressor:function(){this.set("input",null),this.set("output",null)},createGist:function(){var a=this,b={files:{}};b.files[this.get("filename")]={content:this.get("output")},$.ajax({url:"https://api.github.com/gists",type:"POST",dataType:"json",data:JSON.stringify(b)}).done(function(b){a.set("gistUrl",b.files[a.get("filename")].raw_url)})}}}),a.DragAndDrop=Ember.TextArea.extend({didInsertElement:function(){this.$().fileReaderJS({accept:"text/*",dragClass:"dragging",readAsDefault:"Text",on:{load:function(a,b){this.set("value",this.getWithDefault("value","")+a.target.result);var c=b.name.split(".");c.splice(-1,0,"min"),this.set("parentView.controller.filename",c.join("."))}.bind(this)}}),this.$().focus().select()}}),a.OutputTextArea=Ember.TextArea.extend({didInsertElement:function(){this.get("parentView.controller.error")||this.$().focus().select()}}),window.App=a}();